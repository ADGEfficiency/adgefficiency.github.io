---
title: 'The Space Between Money and the Planet'
date: 2021-10-18
categories:
  - Energy
excerpt: Is there an opportunity cost to saving carbon with batteries?

---

<center>
<img src="/assets/space-between/hero.png">
</center>

<br />

I've had this question in the back of my mind for a while - **is there an environmental opportunity cost to making money from battery storage?** 

In this post I'll show how we can to use linear programming to estimate this in terms of a carbon price - how expensive it would be to correct the misalignment between price and carbon signals.

## Importance of battery storage

Battery storage is a key technology for the current energy transition.  Storage is necessary to manage a grid with high levels of variable generation.

Once a wind turbine or solar panel is built, operating that asset is straightforward - you generate as much as you can based on the amount of wind or sun available at that moment.  There is no decision to make or opportunity cost to trade off.

**Batteries however, pose a more challenging control problem than wind or solar**.  A battery must make decisions to charge or discharge, based on an imperfect view of the future and competing objectives.

In the price arbitrage scenario, a battery wants to purchase cheap electricity and sell it at a higher price.  A battery that does the opposite, that charges when electricity prices are high and discharges when they are low, will lose money. 

A battery that charged with dirty electricity and displaced clean electricity would increase carbon.  Charging would increase the load on the dirtier marginal generator, and dispatching will decrease the load on the cleaner marginal generator.


## Price and carbon world

**In an ideal world, we would be able to operate a battery to both make money and save carbon at the same time.**

If clean electricity is cheap and dirty electricity is expensive, we can operate our battery to make money, and know that we will also be saving carbon.

In the opposite world, where dirty electricity is cheap and clean electricity is expensive, there would be an opportunity cost for saving carbon. **There would be situations where you would need to reduce the environmental benefit of operating your battery in order to make more money.**

The delta between these two worlds can be measured in terms of two things we care about - money and carbon. Below is a scenario where there is an opportunity cost to saving carbon - we can measure the delta between these two worlds:

|                 | Optimize for Money   | Optimize for Carbon   | Delta |
| --------------  | -------------------- | --------------------- | ----- |
| Money saved $   | 200                  | 50                    | 150   |
| Carbon saved tC | 10                   | 20                    | 10    |
|                 |                      | **Carbon Price $/tC**      | 15    |

Choosing to prioritize money over carbon means we make `$150` more than if we optimized for carbon, but we generate `10 tC` more than if we optimized for carbon.

This allows us to calculate a carbon price of `15 $/tC`.  This carbon price is the ratio of money gained by optimizing for money to the carbon saving gained by optimizing for carbon. 

This carbon price gives some indication about the level of support (via a carbon tax on electricity market participants) required to counteract the misalignment between our price and carbon signals.  

**We are would be giving the market `$150` to balance out the money that is lost when optimizing for carbon, and receiving `10 tC` of carbon savings in return.**


## Reproducing these results

### View results

If you want to view the results generated by this project, you can grab the results from the [adgefficiency-public](https://s3.console.aws.amazon.com/s3/buckets/adgefficiency-public) S3 bucket.

I recommend installing the `awscli` Python package and syncing the `results` folder to `notebooks/results` (this is where the notebooks that live inside the `notebooks` folder expect the data to be):

```bash
$ pip install awscli
$ aws s3 sync s3://adgefficiency-public/space-between/results ./notebooks/results --no-sign-request
```

After downloading these results you can use the [space-between-viewer](https://github.com/ADGEfficiency/energy-py-linear/blob/master/notebooks/space-between-viewer.ipynb) notebook to inspect them.


### Re-running the experiment

You can run the code that generated these results by cloning energypy-linear at commit [1d19e3e1](https://github.com/ADGEfficiency/energy-py-linear/tree/1d19e3e11d2df48f3007c682afd437159651d062), and running `make space-between` to setup the experiment (you'll need Python installed):

```bash
$ git clone https://github.com/ADGEfficiency/energy-py-linear
$ cd energy-py-linear
$ git checkout 1d19e3e11d2df48f3007c682afd437159651d062
$ make space-between
```

This `make` command will:

- install the `energypylinear` Python package,
- install the `nemdata` Python package,
- use `nemdata` to get price & carbon data.

After running `make space-between`, you can use the [space-between-expt](https://github.com/ADGEfficiency/energy-py-linear/blob/master/notebooks/space-between-expt.ipynb) notebook to run the full experiment.

If you can't get any of this working feel free to email me at [adam.green@adgefficiency.com](mailto:adam.green@adgefficiency.com).

## Methods

This work uses two tools:

1. [nem-data](https://github.com/ADGEfficiency/nem-data) - a Python CLI for downloading Australian electricity market data,
2. [energypy-linear](https://github.com/ADGEfficiency/energy-py-linear) - a Python library for optimizing the dispatch of batteries operating in price arbitrage.

The battery model is a mixed-integer linear program built in PuLP, that optimizes the dispatch of a battery with perfect foresight.  

The only value stream available to the battery is the arbitrage of wholesale electricity from one interval to another.


### Optimize for price or carbon

The battery model can be optimized on one of two objectives - either price or carbon. 

Optimizing for price means the battery will import electricity from the grid at low prices and export it during high prices, leading to an economic saving.

Optimizing for carbon means the battery will import electricity from the grid at low marginal carbon intensity and export it during high marginal carbon intensity, leading to a carbon saving.

Below is an example of optimizing a battery for these two objectives - the left optimizing a battery for money, on the right optimizing a battery for carbon:

![](/assets/space-between/panel.png)

<center><figcaption>Comparing the optimization for price (left) and carbon (right).</figcaption></center>
<br />

An important sense check when looking at optimized battery profiles is that the battery ends the period on zero charge, which happens for both the scenarios above.


### Datasets

Our two objectives of price and carbon require two signals - a price signal and a carbon signal.  For this study I'm using data from 2014 to end of 2020:

- price signal = 30 minute trading price in South Australia,
- carbon signal = 5 minute NEMDE data + NEM generator carbon intensity in South Australia.

The NEMDE data offers a marginal carbon intensity, which is different from the more commonly reported average carbon intensity.  If you aren't clear about the difference, [check out this post on average versus marginal carbon intensity](https://adgefficiency.com/energy-basics-average-vs-marginal-carbon-emissions/).

The 30 minute price data is upsampled to 5 minutes to align with the carbon data. The battery is optimized in monthly blocks.


## Results

The chart below shows the price & carbon benefit from optimizing our battery for price and carbon:

![](/assets/space-between/monthly-benefit.png)

<center><figcaption>Monthly price & carbon benefits when optimizing for price (left) and carbon (right) from 2014 to end of 2020.</figcaption></center>

When we optimize for money, we will have a negative effect on the environment for `53.5 %`of our `84` months.  When we optimize for carbon, we will lose money for `84.5` % of our `84` months.

The chart below again shows the data grouped by month - showing only the delta between our two worlds:

- the price delta - the difference between the optimize for money and optimize for carbon worlds in thousands of Australian dollars per month,
- the carbon delta - the difference between the optimize for money and optimize for carbon worlds in term of tons of carbon savings per month,
- the monthly carbon price - the ratio of our price to carbon deltas.

![](/assets/space-between/monthly.png)

<center><figcaption>Monthly deltas from 2014 to end of 2020.</figcaption></center>

The chart below shows the results grouped by year:

![]({{ '/assets/space-between/annual.png' }})

<center><figcaption>Annual deltas from 2014 to end of 2020.</figcaption></center>

One takeaway from the plot above is that a carbon price of below `100 $/tC` would be enough to fully incentivize batteries to maximize both their economic and carbon savings.

This carbon price would be applied in proportion to the carbon intensity of the electricity produced by each market participant.


## Exploring this carbon price metric

Imagine we have a system where our deltas are `$500` and `50 tC`, giving a carbon price of `$/tC 10`.


What this means is that if we could receive `$500` of income by dispatching in a carbon friendly way, this would be enough to cancel out the `$500` we could have made ignoring carbon and optimizing for price.

|                   | Scenario One | Scenario 2 |
| --------------    | -----        | ---------- |
| Money saved $     | 500          | 400        |
| Carbon saved tC   | 50           | 50         |
| Carbon Price $/tC | 10           | 8          |


This carbon price is a break-even carbon price for the battery - it is what we would have to pay the market to offset the lost revenue of `$500`.


### Effect of efficiency & forecast error on carbon price

If we make mistakes on the dispatch of our battery, we may end up with a delta of `$400` and `50 tC`, giving a carbon price of `$/tC 8`.

Assuming that we still have a delta of `50 tC` may be a stretch (roundtrip efficiency would affect price & carbon performance equally).

I initially found this counter-intuitive - for years I had always thought that high electricity prices would be a good thing for helping to achieve carbon saving from battery storage - there is a reason that the

I'm so used to the idea that high electricity prices are a good thing - however here we see that the more expensive the electricity, the higher of carbon price to counter the value of the that electricity.

The dirtier the electricity, the lower carbon price we need to incentive to save the same amount of money.  This is similar to the value of energy efficiency - highest when replacing dirty or inefficient plant.


## Criticism


### Choice of data

For this study I used the 30 minute South Australia trading price and the 5 minute NEMDE data for a carbon signal.

The intensity from the NEMDE data is a marginal intensity, supplied by the NEMDE solver as the slack variable for increasing demand.

By using this signal we are assuming that any actions we took would not change how the market is dispatched - this will be true up to a point (the size of the marginal bid).

Using different price and carbon signals will change the results of this study - this isn't a fatal criticism but it should reinforce that this study is heavily dependent on the choice of data.

We can add to this the generic but always relevant criticism of anything empirical - you can't use the past to predict the future.


### Perfect foresight

Optimizing with perfect foresight allows us to put an upper limit on both money and carbon savings.  In reality, a battery will be operated with imperfect foresight of future prices.

Because we are interested in the ratio between carbon & economic savings, taking the ratio of maximum carbon to maximum economic savings is hopefully useful. 

We are assuming that the relative dispatch error (in % lost carbon or money) is the same for both objectives.


### Simplistic battery model  

The battery model applies a constant roundtrip efficiency onto battery export - in reality efficiency is a non-linear function of state of charge, battery age, temperature (and probably much more).


### Incorrect battery configuration

This study uses a battery configuration of 1 MW power rating with 2 MWh of capacity - other batteries have different ratios of power to energy.


### Only one value stream

Batteries often have access to many value streams - arbitrage of wholesale electricity is only one of them.  Including other value streams (such as reducing network charges or offering fast response grid services) will change the size of the delta between our two worlds.

---

Thanks for reading!

If you enjoyed this post, check out [Measuring Forecast Quality using Linear Programming](https://adgefficiency.com/energy-py-linear-forecast-quality/), where I show how to use this same battery model to measure the quality of a forecast.


Cited as:
```
@article{green2021spacebetween,
  title   = "The Space Between Money and the Planet",
  author  = "Green, Adam Derek",
  journal = "adgefficiency.github.io",
  year    = "2021",
  url     = "https://adgefficiency.com/space-between-money-and-the-planet/"
}
```
